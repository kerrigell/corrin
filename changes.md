#记录设计和开发过程的尝试和修改


# 设计修改 #
记录设计思想调整，使用模块调整

| 日期 | 内容 | 进度 |
|:-------|:-------|:-------|
| 2013-11-29 | 使用thread.start\_new\_thread的方式测试多线程执行失败 | 0% |
| 2013-11-30  | cmd命令，不再使用cmd2模块自带的参数解析，而是自主使用shlex和optparse配合使用，实现复杂命令用引号间隔正确执行的功能，此方法可以用在今后使用yaml配置命令的动态参数方法上 | 100% |
| 2013-11-29 | 重写cmd命令，使用shlex拆分命令行，再用optparse拆分参数，实现复杂命令输入 | 100% |
| 2013-11-24 | 开始学习twisted，计划使用此模块设计异步消息式操作方式 | 5% |
| 2013-12-05 | nagios命令，增加在centreon中创建监控主机和重启卫星功能。| 100% |
| 2013-12-09 | dbpizza.py 增加process\_list函数，用于统一处理节点或应用列表处理过程，但在传递函数参数时还存在问题，此功能不能使用；晚上参数问题无故解决。| 100% |
| 2013-12-10 |  增加配置文件config/pizza.ini，[pizza](pizza.md)节配置centerid，此数值对应t\_server表内的记录ID，用于在不同环境中构建不同的访问节点网络 | 100% |
| 2013-12-11 | 增加prettytable模块，将命令输出结果表格化显示 | 60% |
| 2013-12-11 | 问题：提示符增加颜色后，输入超过一行后，不会自动换行 2013-12-12 解决 详见issue | 100% |
| 2013-12-12 | 给NetNode和PizzaShell增加encoding属性，提供修改编码接口 | 100% |
| 2013-12-12 | 打印执行结果或运行结果，判断如果结果字符串是多行，采用交叉打印方式，如果只有一行，采用表格方式打印 | 100% |
| 2013-12-13 | 解决数据库连接超时问题，详见Issue | 100% |
| 2013-12-13 | 学习Tornado，可以利用写网络服务和web服务 http://doc.outofmemory.cn/python/tornado/#_9 | 3% |
| 2013-12-17 | 修正了主程序中的多线程代码，"cmd"命令现可以以多线程方式执行命令，但还有1个问题：多线程时消耗时间计算不正确 | 80% |
| 2013-12-17 | 试用了saltstack，突然有种另造轮子的感觉 | 100% |
| 2013-12-18 | 将前身dbpizza的代码迁移到此，修改了对应的主文件名为corrin.py | 100% |
| 2013-12-18 | 发现使用Feature时，那个节点信息不能完全加载。是因为Feature是纵向添加，Server是横向添加。在breed时只判断是否有子节点，如果有就不加载：修改纵向加载方式，每个节点加载全部子节点 | 100%|
| 2013-12-19 | 开发 Iptables 功能，预期能够实现 Iptables 的批量、安全、入库管理，另外能够实现智能识别端口开放情况并以可读样式列出 | 10% |
| 2013-12-19 | Open Sourcing a Python Project the Right Way  http://www.jeffknupp.com/blog/2013/08/16/open-sourcing-a-python-project-the-right-way/ | 0% |
| 2013-12-24 | 增加备份节点功能，在生成秘钥、防火墙时，要读取备份节点信息，保障互备可用 | 0% |
| 2014-01-02 | 增加Operation类，作为操作的基类，收纳初始化dbsession和通用获取数据方法 | 100% |
| 2014-01-07 | 为 dbi 增加自动创建不存在表的功能，详细书写了代码中的表结构定义，保证额外属性没有被遗漏（如自动更新时间戳等）；另外目前还不能自动 ALTER TABLE | 50% |
| 2014-01-20 | 将数据操作移到dbi数据表基类中 | 100% |
|2014-01-21| 使用新数据读取接口，重构node.py中类调用，除iptables以外 | 100% |
| 2014-01-24 | 尝试使用multiprocessing写多进程处理，效果不错，整体结构失败中 | 10% |
| 2014-01-25 | Happy Chinese New Year | 100% |
| 2014-03-24 | 当用户要进行一项多步骤；子步骤需要可重复；调用过程要先写下来，复查，再执行时；用户需要可以固化的脚本，而不是交互式命令行 | 0% |